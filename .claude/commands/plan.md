---
description: 重述需求、评估风险、创建实现计划。等待用户确认后才开始写代码。
---

# Plan 命令

调用 **planner** 代理在编写任何代码之前创建全面的实现计划。

## 功能

1. **重述需求** - 明确需要构建的内容
2. **识别风险** - 发现潜在问题和阻碍
3. **创建步骤计划** - 将实现分解为阶段
4. **等待确认** - 必须获得用户批准后才能继续

## 使用场景

使用 `/plan` 当:
- 开始新功能开发
- 进行重大架构变更
- 复杂的重构工作
- 多个文件/组件将受影响
- 需求不明确或模糊

## 工作流程

1. **分析请求**并用清晰的术语重述需求
2. **分解为阶段**，包含具体可执行的步骤
3. **识别依赖**关系
4. **评估风险**和潜在阻碍
5. **估计复杂度** (高/中/低)
6. **展示计划**并等待明确确认

## 示例

```
User: /plan 添加摄像头实时预览功能

Agent (planner):
# 实现计划: 摄像头实时预览功能

## 需求重述
- 添加摄像头实时视频流采集
- 在 canvas 上显示实时画面
- 支持开始/停止控制
- 与现有图像处理流程集成

## 实现阶段

### 阶段 1: 摄像头工作线程
- 创建 CameraWorker(QThread) 类
- 实现 cv2.VideoCapture 封装
- 添加 FRAME_READY 信号
- 处理摄像头打开/关闭

### 阶段 2: 摄像头控件
- 创建 CameraWidget 组件
- 添加开始/停止按钮
- 添加设备选择下拉框
- 添加 FPS 显示

### 阶段 3: 主窗口集成
- 在 window.py 添加摄像头菜单
- 连接信号到 canvas 显示
- 处理窗口关闭时资源释放

### 阶段 4: 图像处理集成
- 将帧传递给现有 process.py 处理
- 支持实时分析模式

## 依赖
- opencv-python >= 4.9.0

## 风险
- 中: 跨平台摄像头兼容性
- 低: 性能问题 (高分辨率视频流)

## 复杂度: 中

**等待确认**: 是否按此计划执行? (yes/no/modify)
```

## 重要说明

**关键**: 在用户明确确认之前，不会编写任何代码。

如需修改，请回复:
- "修改: [你的变更]"
- "换个方案: [替代方案]"
- "先做阶段3，再做阶段2"

## 与其他命令配合

规划后:
- 使用 `/tdd` 进行测试驱动开发
- 使用 `/build-fix` 修复构建错误
- 使用 `/code-review` 审查实现
